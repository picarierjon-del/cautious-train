<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pizzeria Smart Order - Gemini App</title>
    <!-- Carica Tailwind CSS per uno styling moderno e responsive -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Stile personalizzato per assicurare l'altezza massima su mobile */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7; /* Sfondo generale chiaro */
            padding-bottom: 5rem; /* Spazio per la barra inferiore fissa */
            padding-top: 4rem; /* Spazio per la barra superiore fissa */
        }

        /* Stile per le barre fisse */
        .fixed-bar {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
            backdrop-filter: blur(8px); /* Effetto vetro per un look moderno */
        }

        /* Nasconde lo scrollbar ma permette lo scorrimento (per pulizia estetica) */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- 1. BARRA DI NAVIGAZIONE SUPERIORE (CATEGORIE) -->
    <header id="top-nav" class="fixed-bar fixed top-0 left-0 right-0 z-50 bg-white/90">
        <div class="flex overflow-x-auto hide-scrollbar p-2 space-x-2 border-b border-gray-200">
            <!-- Array dei pulsanti superiori -->
            <script>
                const categories = ['Pizze', 'Baby', 'Calzoni', 'Panini', 'Mezzo Metro', 'Bibite', 'Men√π 17', 'Gourmet'];
                const topNav = document.getElementById('top-nav').querySelector('div');

                categories.forEach((cat, index) => {
                    const button = document.createElement('button');
                    button.textContent = cat;
                    button.className = `px-4 py-2 text-sm font-semibold rounded-full whitespace-nowrap transition duration-150 ease-in-out ${index === 0 ? 'bg-red-600 text-white shadow-lg' : 'bg-gray-100 text-gray-700 hover:bg-red-100'}`;
                    button.onclick = () => selectCategory(cat);
                    topNav.appendChild(button);
                });

                function selectCategory(category) {
                    console.log(`Categoria selezionata: ${category}`);
                    // Logica per caricare i prodotti della categoria qui (es. caricare le pizze)
                    document.getElementById('current-item-name').textContent = category === 'Pizze' ? 'Margherita Classica' : `Primo Articolo di ${category}`;
                    document.getElementById('item-price').textContent = '‚Ç¨ 7.50';
                }

                // Simula la selezione iniziale
                document.addEventListener('DOMContentLoaded', () => {
                    selectCategory('Pizze');
                });
            </script>
        </div>
    </header>

    <!-- 2. CONTENUTO PRINCIPALE SCORREVOLE -->
    <main class="flex-grow p-4 space-y-6">

        <!-- Blocco Esempio Articolo Selezionato (Simulazione) -->
        <section class="bg-white p-4 rounded-xl shadow-lg border border-gray-100">
            <h2 id="current-item-name" class="text-2xl font-extrabold text-gray-800">Margherita Classica</h2>
            <p id="item-price" class="text-3xl font-bold text-red-600 my-2">‚Ç¨ 7.50</p>
            <p class="text-sm text-gray-500 mb-4">Pomodoro, Mozzarella, Basilico fresco, Olio EVO.</p>

            <!-- Placeholder per Aggiunte/Modifiche Correnti -->
            <div id="current-modifiers" class="space-y-2 text-sm">
                <p class="font-semibold text-gray-700">Modifiche Attuali:</p>
                <ul id="modifiers-list" class="list-disc list-inside text-gray-600">
                    <li>Nessuna modifica selezionata.</li>
                </ul>
            </div>
        </section>

        <!-- Blocco Aggiunte/Modifiche con i quattro pulsanti -->
        <section class="mt-8">
            <h3 class="text-xl font-bold text-gray-800 mb-4">Aggiunte e Modifiche Speciali</h3>
            <div class="grid grid-cols-2 gap-4 sm:grid-cols-4">
                <button onclick="showModifierModal('Pi√π', 'Aggiungi Ingredienti')"
                        class="modifier-btn bg-green-500 text-white p-4 rounded-xl shadow-md hover:bg-green-600 transition duration-200 transform hover:scale-105 font-bold text-lg">
                    Pi√π (+)
                </button>
                <button onclick="showModifierModal('Meno', 'Rimuovi Ingredienti')"
                        class="modifier-btn bg-yellow-500 text-white p-4 rounded-xl shadow-md hover:bg-yellow-600 transition duration-200 transform hover:scale-105 font-bold text-lg">
                    Meno (-)
                </button>
                <button onclick="showModifierModal('Poco', 'Quantit√† Ridotta')"
                        class="modifier-btn bg-blue-500 text-white p-4 rounded-xl shadow-md hover:bg-blue-600 transition duration-200 transform hover:scale-105 font-bold text-lg">
                    Poco
                </button>
                <button onclick="showModifierModal('Abbondante', 'Quantit√† Maggiorata')"
                        class="modifier-btn bg-red-500 text-white p-4 rounded-xl shadow-md hover:bg-red-600 transition duration-200 transform hover:scale-105 font-bold text-lg">
                    Abbondante
                </button>
            </div>
        </section>

        <!-- Area per la lista degli articoli (qui andrebbe la lista delle Pizze, Calzoni, etc.) -->
        <section class="mt-8 pt-4 border-t border-gray-200">
            <h3 class="text-xl font-bold text-gray-800 mb-4">Lista Articoli (Esempio)</h3>
            <div class="bg-white p-4 rounded-xl shadow-lg border border-gray-100">
                <p class="text-gray-600">Clicca un pulsante in alto per cambiare categoria, poi usa i pulsanti Pi√π/Meno/Poco/Abbondante per personalizzare l'articolo in evidenza.</p>
                <button class="w-full mt-3 bg-red-100 text-red-700 py-3 rounded-lg font-semibold hover:bg-red-200">Aggiungi al carrello</button>
            </div>
        </section>

    </main>

    <!-- 3. BARRA DI NAVIGAZIONE INFERIORE (MODALIT√Ä ORDINE) -->
    <footer id="bottom-nav" class="fixed-bar fixed bottom-0 left-0 right-0 z-50 bg-white/90 p-3">
        <div class="flex justify-around space-x-2">
            <!-- Array dei pulsanti inferiori -->
            <script>
                const orderModes = [
                    { name: 'A Domicilio', icon: 'üè†', color: 'bg-indigo-600' },
                    { name: 'Asporto', icon: 'üõçÔ∏è', color: 'bg-pink-600' },
                    { name: 'Banco', icon: 'üçΩÔ∏è', color: 'bg-teal-600' }
                ];
                const bottomNav = document.getElementById('bottom-nav').querySelector('div');

                orderModes.forEach((mode, index) => {
                    const button = document.createElement('button');
                    button.innerHTML = `<span class="text-xl">${mode.icon}</span> ${mode.name}`;
                    button.className = `flex-1 flex flex-col items-center justify-center p-2 rounded-xl text-xs font-semibold text-white transition duration-150 ease-in-out ${mode.color} shadow-lg hover:opacity-90`;
                    button.onclick = () => selectOrderMode(mode.name);
                    bottomNav.appendChild(button);
                });

                function selectOrderMode(mode) {
                    // Logica per selezionare la modalit√† di ordine
                    console.log(`Modalit√† ordine selezionata: ${mode}`);
                    alertSmart(`Modalit√† Ordine Impostata: ${mode}`);
                }
            </script>
        </div>
    </footer>

    <!-- 4. MODAL PER AGGIUNTE E MODIFICHE (Il "men√π a tendina" dinamico) -->
    <div id="modifier-modal" class="fixed inset-0 bg-gray-900 bg-opacity-70 flex items-end justify-center z-[100] hidden transition-opacity duration-300 opacity-0" onclick="closeModifierModal(event)">
        <div id="modal-content" class="bg-white w-full rounded-t-3xl shadow-2xl transform translate-y-full transition-transform duration-300 p-6 space-y-4" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center border-b pb-3 mb-2">
                <h3 id="modal-title" class="text-2xl font-extrabold text-gray-800">Aggiungi Ingredienti</h3>
                <button onclick="closeModifierModal()" class="text-gray-500 hover:text-gray-800 text-2xl font-light">&times;</button>
            </div>

            <p id="modal-subtitle" class="text-sm text-gray-500">Seleziona le aggiunte per l'articolo Margherita Classica.</p>

            <!-- Lista Dinamica delle Opzioni -->
            <div id="options-list" class="space-y-3 max-h-80 overflow-y-auto hide-scrollbar">
                <!-- Verr√† popolato da JS -->
            </div>

            <button onclick="applyModifiers()" class="w-full bg-red-600 text-white font-bold py-3 rounded-xl shadow-lg hover:bg-red-700 transition duration-200">
                Conferma Aggiunte
            </button>
        </div>
    </div>

    <!-- 5. Funzione Sostitutiva di alert() (Mostra un messaggio personalizzato) -->
    <div id="custom-alert" class="fixed top-4 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-full shadow-xl opacity-0 transition-opacity duration-300 z-[200]" style="pointer-events: none;">
        Messaggio di prova
    </div>

    <!-- LOGICA JAVASCRIPT -->
    <script>
        // Array globale per tenere traccia delle modifiche attuali
        let activeModifiers = [];

        // Dati di esempio per le aggiunte (simula il men√π a tendina)
        const additionOptions = [
            { name: 'Mozzarella di bufala', price: 2.00, type: 'Pi√π' },
            { name: 'Prosciutto Cotto', price: 1.50, type: 'Pi√π' },
            { name: 'Sale Piccante', price: 0.50, type: 'Pi√π' },
            { name: 'Crostacei', price: 5.00, type: 'Pi√π' },
            { name: 'Funghi Porcini', price: 2.50, type: 'Pi√π' },
            { name: 'Basilico Extra', price: 0.50, type: 'Abbondante' },
            { name: 'Meno Pomodoro', price: 0.00, type: 'Meno' },
            { name: 'Poco Olio EVO', price: 0.00, type: 'Poco' },
        ];

        // Riferimenti agli elementi DOM
        const modal = document.getElementById('modifier-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalSubtitle = document.getElementById('modal-subtitle');
        const optionsList = document.getElementById('options-list');
        const currentModifiersList = document.getElementById('modifiers-list');

        let currentModifierType = ''; // Tiene traccia del tipo di modifica (+, -, Poco, Abbondante)

        /**
         * Funzione per mostrare la modale delle aggiunte.
         * Viene chiamata quando si clicca uno dei 4 pulsanti (Pi√π, Meno, Poco, Abbondante).
         * @param {string} type - Il tipo di modifica ('Pi√π', 'Meno', 'Poco', 'Abbondante')
         * @param {string} title - Titolo da mostrare nella modale
         */
        function showModifierModal(type, title) {
            currentModifierType = type;
            const itemName = document.getElementById('current-item-name').textContent;

            // 1. Aggiorna i testi della modale
            modalTitle.textContent = title + ` (${type})`;
            modalSubtitle.textContent = `Seleziona le modifiche di tipo "${type}" per l'articolo ${itemName}.`;

            // 2. Filtra le opzioni in base al tipo di modifica
            const filteredOptions = additionOptions.filter(opt => opt.type === type);

            // 3. Popola la lista delle opzioni
            optionsList.innerHTML = ''; // Pulisce le opzioni precedenti
            if (filteredOptions.length === 0) {
                optionsList.innerHTML = `<p class="text-gray-500 italic">Nessuna opzione di tipo "${type}" disponibile per questo articolo.</p>`;
                return;
            }

            filteredOptions.forEach(option => {
                const isChecked = activeModifiers.some(mod => mod.name === option.name);
                const item = document.createElement('div');
                item.className = 'flex justify-between items-center p-3 bg-gray-50 rounded-lg border border-gray-200 cursor-pointer hover:bg-gray-100 transition duration-150';

                item.innerHTML = `
                    <label class="flex items-center space-x-3 w-full cursor-pointer">
                        <input type="checkbox" data-name="${option.name}" data-price="${option.price}" data-type="${option.type}"
                               class="h-5 w-5 text-red-600 rounded focus:ring-red-500" ${isChecked ? 'checked' : ''} onchange="toggleModifier(this)">
                        <span class="text-base font-medium text-gray-700">${option.name}</span>
                    </label>
                    <span class="text-sm font-semibold text-red-500">+‚Ç¨ ${option.price.toFixed(2)}</span>
                `;
                optionsList.appendChild(item);
            });

            // 4. Mostra la modale con animazione
            modal.classList.remove('hidden', 'opacity-0');
            modal.classList.add('flex');
            setTimeout(() => {
                modal.classList.add('opacity-100');
                document.getElementById('modal-content').classList.remove('translate-y-full');
            }, 10); // Piccolo ritardo per l'animazione CSS
        }

        /** Gestisce l'aggiunta/rimozione della modifica al click della checkbox */
        function toggleModifier(checkbox) {
            const { name, price, type } = checkbox.dataset;
            const newModifier = { name, price: parseFloat(price), type };

            if (checkbox.checked) {
                // Aggiungi se non esiste gi√†
                if (!activeModifiers.some(mod => mod.name === name)) {
                    activeModifiers.push(newModifier);
                }
            } else {
                // Rimuovi
                activeModifiers = activeModifiers.filter(mod => mod.name !== name);
            }
            console.log("Modifiche temporanee:", activeModifiers);
        }

        /** Applicare le modifiche e chiudere la modale */
        function applyModifiers() {
            updateModifiersDisplay();
            closeModifierModal();
            alertSmart("Modifiche aggiunte con successo!");
        }

        /** Funzione per chiudere la modale */
        function closeModifierModal(event) {
            // Chiudi solo se l'evento √® un click sullo sfondo (modal overlay) o sul pulsante 'x'
            if (event && event.target.id !== 'modifier-modal' && event.target.id !== 'close-btn') {
                return;
            }
            // Rimuove l'animazione di entrata e chiude la modale
            document.getElementById('modal-content').classList.add('translate-y-full');
            modal.classList.remove('opacity-100');
            setTimeout(() => {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }, 300); // Abbina la durata della transizione CSS
        }

        /** Aggiorna la lista delle modifiche nell'area di contenuto principale */
        function updateModifiersDisplay() {
            currentModifiersList.innerHTML = '';
            if (activeModifiers.length === 0) {
                currentModifiersList.innerHTML = '<li>Nessuna modifica selezionata.</li>';
                return;
            }
            activeModifiers.forEach(mod => {
                const li = document.createElement('li');
                let costText = mod.price > 0 ? ` (+‚Ç¨ ${mod.price.toFixed(2)})` : '';
                li.innerHTML = `[${mod.type}] ${mod.name}${costText}`;
                currentModifiersList.appendChild(li);
            });
        }

        /** Sostituzione di alert() con un messaggio toast per mobile */
        function alertSmart(message) {
            const alertDiv = document.getElementById('custom-alert');
            alertDiv.textContent = message;

            // Mostra
            alertDiv.classList.add('opacity-100');

            // Nascondi dopo 3 secondi
            setTimeout(() => {
                alertDiv.classList.remove('opacity-100');
            }, 3000);
        }

    </script>
</body>
</html>

